:root { color-scheme: light dark; }

html,body {
  height:100%; margin:0; overflow:hidden;
  font-family:system-ui, Arial, sans-serif;
  background: var(--color-bg);
  background-image: var(--background-image);
    background-size:cover;
  color: var(--color-text);
}

.feed-layout {
  height:100vh; display:flex; align-items:center; justify-content:center;
}

.feed-grid {
  display:grid;
  grid-template-columns:0.8fr 1fr 0.8fr;
  gap:1rem;
  width:100%; max-width:80%;
  height:95vh;
}

.panel {
  background: var(--color-panel-bg-glass); /* semi-transparent for blur */
  backdrop-filter: blur(14px) saturate(120%);
  -webkit-backdrop-filter: blur(14px) saturate(120%);
  border: 1px solid var(--color-panel-border);
  border-radius: 8px;
  color: var(--color-text);
  box-shadow: 0 4px 18px rgba(0,0,0,0.12);
  position: relative;
  overflow: auto;
}

.panel.hidden {
  opacity:0; visibility:hidden; pointer-events:none;
}

.content-wrapper {
  display:flex;
  justify-content:center;
  align-items:stretch;
  gap:1rem;
  position:relative;
  height:100%;
  padding:0.5rem;
  box-sizing:border-box;
}

.content-card {
  display:flex;
  align-items:center;
  justify-content:center;
  width:min(30rem,100%);
  max-width:30rem;
  height:100%;
  margin:0;
}

.content-card > .content {
  width:100%;
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
}

.buttons-col {
  display:flex;
  flex-direction:column;
  gap:.75rem;
  align-items:center;
  justify-content:center;
  height:100%;
}

.side-btn {
  display:flex; align-items:center; justify-content:center;
  width:2.5rem; height:2.5rem;
  border-radius:15px;
  border:1px solid var(--color-panel-border);
  color: var(--color-text);
  font-size:22px;
  cursor:pointer;
  box-shadow:0 2px 6px rgba(0,0,0,.12);
}

  #mobileCloseBtn {
    display: none;
    position: fixed;
    right: 0.75rem;
    top: 1.5rem;
    z-index: 60;
    align-items: center;
    justify-content: center;
    width: 2.5rem;
    height: 2.5rem;
    border-radius: 35%;
    color: var(--color-text);
    border: 1px solid var(--color-panel-border);
    box-shadow: 0 2px 6px rgba(0,0,0,.12);
    font-size: 22px;
    cursor: pointer;
  }

@media (hover: hover) and (pointer: fine) {
  .side-btn, #mobileCloseBtn {
    transition:
      transform .15s ease,
      box-shadow .15s ease,
      background-color .15s ease,
      border-color .15s ease,
      color .15s ease;
  }
  .side-btn .button_image {
    transition: filter .15s ease, transform .15s ease;
  }
  .side-btn:hover {
    transform: translateY(-2px) scale(1.06);
    box-shadow: 0 6px 14px rgba(0,0,0,.18);
    /* background/color on hover already handled in globals.css */
  }
  .side-btn:hover .button_image {
    /* Make dark PNGs appear white on accent hover */
    filter: brightness(0) invert(1) drop-shadow(0 1px 1px rgba(0,0,0,.25));
  }
}

.side-btn:focus-visible { outline:3px solid var(--color-accent); outline-offset:2px; }

.post { width:100%; max-width:30rem; }
.empty-image { width:100%; height:auto; }

.button_image { width:25px; height:25px; }

.shortfeed {
  height:100vh;
  width:100%;
  overflow-y:scroll;
  scroll-snap-type:y mandatory;
}
.shortfeed::-webkit-scrollbar { width:0; }
.short-card {
  position:relative;
  min-height:100vh;
  scroll-snap-align:start;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  box-sizing:border-box;
}
.short-card video,
.short-card img {
  width:100%;
  max-width:100%;
  max-height:80vh;
  height:auto;
  display:block;
  border-radius:14px;
  object-fit:cover;
 }

@media (max-width:1300px) {
  .feed-grid { display:flex; justify-content:center; position:relative; }

  #contentPanel {
    position:relative;
    z-index:1;
    opacity:1; visibility:visible; pointer-events:auto;
  }

  #userPanel, #commentsPanel {
    position:absolute;
    top:0; left:50%; bottom:0;
    width:min(30rem,100%);
    max-width:30rem;
    transform:translateX(-50%);
    margin:0;
    overflow:auto;
    opacity:0; visibility:hidden; pointer-events:none;
    z-index:50;
  }

  #userPanel.active, #commentsPanel.active {
    opacity:1; visibility:visible; pointer-events:auto;
  }

  .content-wrapper { position:relative; }
}

  /* only show the X on small screens when a panel is active */
  @media (max-width:760px) {
    /* keep small-screen positioning/appearance */
    #mobileCloseBtn { display: none; }

    /* modern browsers: show when panel becomes active */
    body:has(#userPanel.active) #mobileCloseBtn,
    body:has(#commentsPanel.active) #mobileCloseBtn {
      display: flex;
    }

    .content-wrapper{
      gap: 0.5rem;
      padding:0;
    }

    .feed-grid{
        max-width:100%;
    }

    /* fallback for browsers without :has(): show when JS toggles body.close-visible */
    body.close-visible #mobileCloseBtn {
      display: flex;
    }

    /* keep the other small-screen adjustments */
    .content-card { width: min(22rem,100%); }
    .content-wrapper .right-buttons { display: none; }
  }